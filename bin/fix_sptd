#!/bin/sh

journalctl --user -u spotifyd -b -f -n 1 | while IFS= read -r spt_log; do
    if [[ "$spt_log" == *"Err(Unauthorized)"* ]]; then
        systemctl --user restart spotifyd
        until spt pb --transfer=Daemon
        do
            sleep 0.5
        done
    fi
done
